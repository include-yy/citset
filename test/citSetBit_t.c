#include <stdio.h>
#include <stdint.h>
#include "citset.h"

/* little-endian is required to get the expected result. (X86) */
/* test on citSetBit(void * bitfield, size_t index, int symbol) */

void print_bit(const void * bitfield, size_t start, size_t end);

int main(void)
{
    uint8_t array8[5] = {0};
    for (int i = 0; i < 40; i++)
    {
        citSetBit(array8, i, 1);
        print_bit(array8, 0, 40);
        putchar('\n');
    }
    putchar('\n');
    float testfl = 2.0;
    printf("%-50f ", testfl);
    print_bit(&testfl, 0, 32), putchar('\n');

    citSetBit(&testfl, 16, 1);
    printf("%-50f ", testfl);
    print_bit(&testfl, 0, 32), putchar('\n');

    for (int i = 0; i < 6; i++)
    {
        citSetBit(&testfl, 31 - i, 1);
        printf("%-50f ", testfl);
        print_bit(&testfl, 0, 32), putchar('\n');
    }
    citSetBit(&testfl, 16, 0);
    printf("%-50f ", testfl);
    print_bit(&testfl, 0, 32), putchar('\n');

    citSet(&testfl, 0, 16, 1);
    citSet(&testfl, 17, 24, 1);
    printf("%-50f ", testfl);
    print_bit(&testfl, 0, 32), putchar('\n');

    return 0;
}

void print_bit(const void * bitfield, size_t start, size_t end)
{
    int per_eight = 0;
    for (; start < end; start = start + 1)
    {
        if (per_eight == 8)
        {
            putchar(' ');
            per_eight = 0;
        }
        per_eight++;
        printf("%d", citGetBit(bitfield, start));
    }
}

/* the expected result */

/*
10000000 00000000 00000000 00000000 00000000
11000000 00000000 00000000 00000000 00000000
11100000 00000000 00000000 00000000 00000000
11110000 00000000 00000000 00000000 00000000
11111000 00000000 00000000 00000000 00000000
11111100 00000000 00000000 00000000 00000000
11111110 00000000 00000000 00000000 00000000
11111111 00000000 00000000 00000000 00000000
11111111 10000000 00000000 00000000 00000000
11111111 11000000 00000000 00000000 00000000
11111111 11100000 00000000 00000000 00000000
11111111 11110000 00000000 00000000 00000000
11111111 11111000 00000000 00000000 00000000
11111111 11111100 00000000 00000000 00000000
11111111 11111110 00000000 00000000 00000000
11111111 11111111 00000000 00000000 00000000
11111111 11111111 10000000 00000000 00000000
11111111 11111111 11000000 00000000 00000000
11111111 11111111 11100000 00000000 00000000
11111111 11111111 11110000 00000000 00000000
11111111 11111111 11111000 00000000 00000000
11111111 11111111 11111100 00000000 00000000
11111111 11111111 11111110 00000000 00000000
11111111 11111111 11111111 00000000 00000000
11111111 11111111 11111111 10000000 00000000
11111111 11111111 11111111 11000000 00000000
11111111 11111111 11111111 11100000 00000000
11111111 11111111 11111111 11110000 00000000
11111111 11111111 11111111 11111000 00000000
11111111 11111111 11111111 11111100 00000000
11111111 11111111 11111111 11111110 00000000
11111111 11111111 11111111 11111111 00000000
11111111 11111111 11111111 11111111 10000000
11111111 11111111 11111111 11111111 11000000
11111111 11111111 11111111 11111111 11100000
11111111 11111111 11111111 11111111 11110000
11111111 11111111 11111111 11111111 11111000
11111111 11111111 11111111 11111111 11111100
11111111 11111111 11111111 11111111 11111110
11111111 11111111 11111111 11111111 11111111
2.000000                                           00000000 00000000 00000000 01000000
4.000000                                           00000000 00000000 10000000 01000000
16.000000                                          00000000 00000000 10000000 01000001
256.000000                                         00000000 00000000 10000000 01000011
65536.000000                                       00000000 00000000 10000000 01000111
4294967296.000000                                  00000000 00000000 10000000 01001111
18446744073709552000.000000                        00000000 00000000 10000000 01011111
1.#INF00                                           00000000 00000000 10000000 01111111
170141183460469230000000000000000000000.000000     00000000 00000000 00000000 01111111
340282346638528860000000000000000000000.000000     11111111 11111111 01111111 01111111
*/